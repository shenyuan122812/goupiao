{"remainingRequest":"D:\\项目\\movie\\vue-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\项目\\movie\\vue-admin\\src\\views\\worker\\List.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\项目\\movie\\vue-admin\\src\\views\\worker\\List.vue","mtime":1617354797154},{"path":"D:\\项目\\movie\\vue-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\项目\\movie\\vue-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7CiAgICBDcmVhdGVXb3JrZXJSb2xlLAogICAgRGVsZXRlUm9sZUJ5V29ya2VySWQsCiAgICBEZWxldGVXb3JrZXIsCiAgICBGaW5kQWxsV29ya2VyLAogICAgRmluZFdvcmtlclJvbGVzLAogICAgTGlzdFN5c3RlbVJvbGVzLAogICAgVXBkYXRlV29ya2VyCn0gZnJvbSAiQC9hcGkvd29ya2VyIjsKCmV4cG9ydCBkZWZhdWx0IHsKCgogICAgZGF0YSgpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBsb2FkaW5nOiBmYWxzZSwKICAgICAgICAgICAgYWRkUm9sZUZvcm06IHsKICAgICAgICAgICAgICAgIHdpZDogJycsCiAgICAgICAgICAgICAgICB2YWx1ZTogJycsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHdvcmtlckxpc3Q6IFtdLAogICAgICAgICAgICBzeXN0ZW1Sb2xlczogW10sCiAgICAgICAgICAgIHJvbGVEaWFsb2dWaXNpYmxlOiBmYWxzZSwKICAgICAgICAgICAgcm9sZUxpc3Q6IFtdLAogICAgICAgICAgICBkaWFsb2dGb3JtVmlzaWJsZTogZmFsc2UsCiAgICAgICAgfQogICAgfSwKCiAgICBtb3VudGVkKCkgewogICAgICAgIEZpbmRBbGxXb3JrZXIoKS50aGVuKHJlcyA9PiB7CiAgICAgICAgICAgIHRoaXMud29ya2VyTGlzdCA9IHJlcy5kYXRhCiAgICAgICAgfSkKICAgICAgICBMaXN0U3lzdGVtUm9sZXMoKS50aGVuKHJlcyA9PiB7CiAgICAgICAgICAgIHRoaXMuc3lzdGVtUm9sZXMgPSByZXMuZGF0YQogICAgICAgIH0pCiAgICB9LAoKICAgIG1ldGhvZHM6IHsKCiAgICAgICAgb3BlblVwZGF0ZVBhc3N3b3JkKHdvcmtlcikgewogICAgICAgICAgICB0aGlzLiRwcm9tcHQoJ+ivt+i+k+WFpeaWsOeahOWvhueggScsICfmj5DnpLonLCB7CiAgICAgICAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+ehruWumicsCiAgICAgICAgICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAn5Y+W5raIJywKICAgICAgICAgICAgfSkudGhlbigoe3ZhbHVlfSkgPT4gewogICAgICAgICAgICAgICAgaWYgKCF2YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAn5a+G56CB5LiN6IO95Li656m6JywKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2RhbmdlcicsCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAodmFsdWUubGVuZ3RoIDwgNikgewogICAgICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAn6K+36L6T5YWl5LiN5bCR5LqONuS9jeeahOWvhueggScsCiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdkYW5nZXInLAogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgd29ya2VyLnBhc3N3b3JkID0gdmFsdWUKICAgICAgICAgICAgICAgIFVwZGF0ZVdvcmtlcih3b3JrZXIpLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogJ+i0puWPt+WvhueggeS/ruaUueaIkOWKnycsCiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJywKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0pLmNhdGNoKCgpID0+IHsKICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgICAgICAgICAgIHR5cGU6ICdpbmZvJywKICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAn5Y+W5raI5L+u5pS5JwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCgogICAgICAgIGNoYW5nZUVudHJ5KGluZGV4LCB3b3JrZXIpIHsKICAgICAgICAgICAgdGhpcy4kY29uZmlybSgn5q2k5pON5L2c5bCG6K+l5ZGY5bel54q25oCB5rC45LmF5L+u5pS55Li656a76IGMLCDmmK/lkKbnu6fnu60/JywgJ+aPkOekuicsIHsKICAgICAgICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAn56Gu5a6aJywKICAgICAgICAgICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICflj5bmtognLAogICAgICAgICAgICAgICAgdHlwZTogJ3dhcm5pbmcnCiAgICAgICAgICAgIH0pLnRoZW4oKCkgPT4gewogICAgICAgICAgICAgICAgd29ya2VyLmVudHJ5ID0gZmFsc2UKICAgICAgICAgICAgICAgIFVwZGF0ZVdvcmtlcih3b3JrZXIpLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLAogICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAn5ZGY5bel56a76IGM5oiQ5YqfIScKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0pCiAgICAgICAgfSwKCiAgICAgICAgaGFuZGxlRGVsZXRlV29yayhpbmRleCwgaWQpIHsKICAgICAgICAgICAgRGVsZXRlV29ya2VyKGlkKS50aGVuKHJlcyA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLndvcmtlckxpc3Quc3BsaWNlKGluZGV4LCAxKQogICAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLAogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICflkZjlt6Xkv6Hmga/liKDpmaTmiJDlip8hJwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pCiAgICAgICAgfSwKCiAgICAgICAgaGFuZGxlTGlzdFJvbGUod29ya2VyKSB7CiAgICAgICAgICAgIHRoaXMucm9sZURpYWxvZ1Zpc2libGUgPSB0cnVlOwogICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlOwogICAgICAgICAgICBGaW5kV29ya2VyUm9sZXMod29ya2VyLmlkKS50aGVuKHJlcyA9PiB7CiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICB0aGlzLnJvbGVMaXN0ID0gcmVzLmRhdGEKICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICAgIH0sIDcwMCkKICAgICAgICAgICAgfSkKICAgICAgICB9LAoKICAgICAgICBoYW5kbGVEZWxldGVSb2xlKGluZGV4LCBpZCkgewogICAgICAgICAgICBEZWxldGVSb2xlQnlXb3JrZXJJZChpZCkudGhlbihyZXMgPT4gewogICAgICAgICAgICAgICAgaWYgKHJlcy5zdWNjZXNzID09PSB0cnVlKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5yb2xlTGlzdC5zcGxpY2UoaW5kZXgsIDEpCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJywKICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogJ+WRmOW3peadg+mZkOWIoOmZpOaIkOWKnyEnCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgfSwKCiAgICAgICAgaGFuZGxlQWRkUm9sZSh3b3JrZXIpIHsKICAgICAgICAgICAgdGhpcy5kaWFsb2dGb3JtVmlzaWJsZSA9IHRydWU7CiAgICAgICAgICAgIHRoaXMuYWRkUm9sZUZvcm0ud2lkID0gd29ya2VyLmlkOwogICAgICAgIH0sCgogICAgICAgIHN1Ym1pdEFkZFJvbGUoKSB7CiAgICAgICAgICAgIENyZWF0ZVdvcmtlclJvbGUodGhpcy5hZGRSb2xlRm9ybSkudGhlbihyZXMgPT4gewogICAgICAgICAgICAgICAgaWYgKHJlcy5zdWNjZXNzKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5kaWFsb2dGb3JtVmlzaWJsZSA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkUm9sZUZvcm0ud2lkID0gJyc7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGRSb2xlRm9ybS52YWx1ZSA9ICcnOwogICAgICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycsCiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICflkZjlt6XmnYPpmZDmt7vliqDmiJDlip8hJwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KQogICAgICAgIH0sCgogICAgfSwKCn0K"},{"version":3,"sources":["List.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA","file":"List.vue","sourceRoot":"src/views/worker","sourcesContent":["<template>\n    <div class=\"main\">\n\n        <el-table\n                :data=\"workerList\"\n                style=\"width: 100%\">\n            <el-table-column type=\"expand\">\n                <template slot-scope=\"props\">\n                    <el-form label-position=\"left\" inline class=\"demo-table-expand\">\n                        <el-form-item label=\"用户名\">\n                            <span>{{ props.row.username }}</span>\n                        </el-form-item>\n                        <el-form-item label=\"昵称\">\n                            <span>{{ props.row.nickname }}</span>\n                        </el-form-item>\n                        <el-form-item label=\"密码\">\n                            <el-button type=\"text\" @click=\"openUpdatePassword(props.row)\">\n                                <i class=\"el-icon-edit\"></i>编辑密码\n                            </el-button>\n                        </el-form-item>\n                        <el-form-item label=\"联系电话\">\n                            <span>{{ props.row.phone }}</span>\n                        </el-form-item>\n                        <el-form-item label=\"性别\">\n                            <span>{{ props.row.gender }}</span>\n                        </el-form-item>\n                        <el-form-item label=\"入职部门\">\n                            <span>{{ props.row.department }}</span>\n                        </el-form-item>\n                        <el-form-item label=\"状态\">\n              <span v-if=\"props.row.entry\">在职\n              <el-button @click=\"changeEntry(props.$index, props.row)\" type=\"text\">员工已离职？</el-button></span>\n                            <span style=\"color: #f56c6c\" v-else>离职</span>\n                        </el-form-item>\n                        <el-form-item label=\"更新时间\">\n                            <span>{{ props.row.updateAt }}</span>\n                        </el-form-item>\n                        <el-form-item label=\"员工头像\">\n                            <a v-if=\"props.row.avatar\" target=\"_blank\" :href=\"props.row.avatar\">\n                                <i class=\"el-icon-view\"></i>查看\n                            </a>\n                            <span v-else>他还没有上传头像</span>\n                        </el-form-item>\n                        <el-form-item>\n                            <el-button :disabled=\"!props.row.entry\"\n                                       @click=\"handleListRole(props.row)\"\n                                       type=\"info\"\n                                       size=\"small\"\n                                       plain>查看权限\n                            </el-button>\n                            <el-button :disabled=\"!props.row.entry\"\n                                       type=\"primary\"\n                                       @click=\"handleAddRole(props.row)\"\n                                       size=\"small\"\n                                       plain>添加权限\n                            </el-button>\n                            <el-button :disabled=\"props.row.entry\"\n                                       @click=\"handleDeleteWork(props.$index, props.row.id)\"\n                                       size=\"small\"\n                                       type=\"danger\"\n                                       plain>删除员工\n                            </el-button>\n                        </el-form-item>\n                    </el-form>\n                </template>\n            </el-table-column>\n\n            <el-table-column\n                    label=\"员工 ID\"\n                    width=\"430\"\n                    prop=\"id\">\n            </el-table-column>\n            <el-table-column\n                    label=\"用户名\"\n                    width=\"200\"\n                    prop=\"username\">\n            </el-table-column>\n            <el-table-column\n                    label=\"所在部门\"\n                    width=\"150\">\n                <template slot-scope=\"scope\">\n                    <el-tag>{{ scope.row.department }}</el-tag>\n                </template>\n            </el-table-column>\n            <el-table-column\n                    label=\"联系电话\"\n                    width=\"240\"\n                    prop=\"phone\">\n            </el-table-column>\n            <el-table-column\n                    label=\"入职时间\"\n                    prop=\"createAt\">\n            </el-table-column>\n\n        </el-table>\n\n        <el-dialog title=\"员工权限\" :visible.sync=\"roleDialogVisible\">\n            <el-table v-loading=\"loading\" :data=\"roleList\">\n                <el-table-column property=\"value\" label=\"权限\" width=\"300\"></el-table-column>\n                <el-table-column property=\"createAt\" label=\"创建时间\" width=\"300\"></el-table-column>\n                <el-table-column label=\"操作\">\n                    <template slot-scope=\"scope\">\n                        <el-popconfirm\n                                @confirm=\"handleDeleteRole(scope.$index, scope.row.id)\"\n                                :title=\"'确定删除权限 < ' + scope.row.value +' > 吗？'\"\n                        >\n                            <el-button slot=\"reference\" size=\"small\" type=\"danger\" icon=\"el-icon-delete\" plain>删除\n                            </el-button>\n                        </el-popconfirm>\n                    </template>\n                </el-table-column>\n            </el-table>\n        </el-dialog>\n\n        <el-dialog width=\"450px\" title=\"新增权限\" :visible.sync=\"dialogFormVisible\">\n            <el-form :model=\"addRoleForm\">\n                <el-form-item label=\"权限列表\" label-width=\"120px\">\n                    <el-select v-model=\"addRoleForm.value\" placeholder=\"请选择新增的权限\">\n                        <el-option v-for=\"(item, index) in systemRoles\"\n                                   :key=\"index\"\n                                   :label=\"item\"\n                                   :value=\"item\">\n                        </el-option>\n                    </el-select>\n                </el-form-item>\n            </el-form>\n            <div slot=\"footer\" class=\"dialog-footer\">\n                <el-button @click=\"dialogFormVisible = false\">取 消</el-button>\n                <el-button type=\"primary\" @click=\"submitAddRole\">确 定</el-button>\n            </div>\n        </el-dialog>\n\n    </div>\n</template>\n\n<script>\n    import {\n        CreateWorkerRole,\n        DeleteRoleByWorkerId,\n        DeleteWorker,\n        FindAllWorker,\n        FindWorkerRoles,\n        ListSystemRoles,\n        UpdateWorker\n    } from \"@/api/worker\";\n\n    export default {\n\n\n        data() {\n            return {\n                loading: false,\n                addRoleForm: {\n                    wid: '',\n                    value: '',\n                },\n                workerList: [],\n                systemRoles: [],\n                roleDialogVisible: false,\n                roleList: [],\n                dialogFormVisible: false,\n            }\n        },\n\n        mounted() {\n            FindAllWorker().then(res => {\n                this.workerList = res.data\n            })\n            ListSystemRoles().then(res => {\n                this.systemRoles = res.data\n            })\n        },\n\n        methods: {\n\n            openUpdatePassword(worker) {\n                this.$prompt('请输入新的密码', '提示', {\n                    confirmButtonText: '确定',\n                    cancelButtonText: '取消',\n                }).then(({value}) => {\n                    if (!value) {\n                        this.$message({\n                            message: '密码不能为空',\n                            type: 'danger',\n                        });\n                        return\n                    }\n                    if (value.length < 6) {\n                        this.$message({\n                            message: '请输入不少于6位的密码',\n                            type: 'danger',\n                        });\n                        return\n                    }\n                    worker.password = value\n                    UpdateWorker(worker).then(res => {\n                        this.$message({\n                            message: '账号密码修改成功',\n                            type: 'success',\n                        });\n                    })\n                }).catch(() => {\n                    this.$message({\n                        type: 'info',\n                        message: '取消修改'\n                    });\n                });\n            },\n\n            changeEntry(index, worker) {\n                this.$confirm('此操作将该员工状态永久修改为离职, 是否继续?', '提示', {\n                    confirmButtonText: '确定',\n                    cancelButtonText: '取消',\n                    type: 'warning'\n                }).then(() => {\n                    worker.entry = false\n                    UpdateWorker(worker).then(res => {\n                        this.$message({\n                            type: 'success',\n                            message: '员工离职成功!'\n                        });\n                    })\n                })\n            },\n\n            handleDeleteWork(index, id) {\n                DeleteWorker(id).then(res => {\n                    this.workerList.splice(index, 1)\n                    this.$message({\n                        type: 'success',\n                        message: '员工信息删除成功!'\n                    });\n                })\n            },\n\n            handleListRole(worker) {\n                this.roleDialogVisible = true;\n                this.loading = true;\n                FindWorkerRoles(worker.id).then(res => {\n                    setTimeout(() => {\n                        this.roleList = res.data\n                        this.loading = false;\n                    }, 700)\n                })\n            },\n\n            handleDeleteRole(index, id) {\n                DeleteRoleByWorkerId(id).then(res => {\n                    if (res.success === true) {\n                        this.roleList.splice(index, 1)\n                        this.$message({\n                            type: 'success',\n                            message: '员工权限删除成功!'\n                        });\n                    }\n                })\n            },\n\n            handleAddRole(worker) {\n                this.dialogFormVisible = true;\n                this.addRoleForm.wid = worker.id;\n            },\n\n            submitAddRole() {\n                CreateWorkerRole(this.addRoleForm).then(res => {\n                    if (res.success) {\n                        this.dialogFormVisible = false;\n                        this.addRoleForm.wid = '';\n                        this.addRoleForm.value = '';\n                        this.$message({\n                            type: 'success',\n                            message: '员工权限添加成功!'\n                        });\n                    }\n                })\n            },\n\n        },\n\n    }\n</script>\n\n<style scoped>\n    .demo-table-expand {\n        font-size: 0;\n    }\n\n    .demo-table-expand label {\n        width: 90px;\n        color: #99a9bf;\n    }\n\n    .demo-table-expand .el-form-item {\n        margin-right: 0;\n        margin-bottom: 0;\n        width: 50%;\n    }\n</style>"]}]}